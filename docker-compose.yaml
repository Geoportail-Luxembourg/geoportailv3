---

# The project Docker compose file for development.

version: '2.0'

services:
  config:
    extends:
      file: docker-compose-lib.yaml
      service: config

  print:
    extends:
      file: docker-compose-lib.yaml
      service: print
    volumes_from:
      - config:ro
    ports:
      - 28080:8080
    environment:
      - CATALINA_OPTS=-Xmx1024m
      - PGOPTIONS=-c statement_timeout=30000

  redis:
    extends:
      file: docker-compose-lib.yaml
      service: redis

  geoportal:
    extends:
      file: docker-compose-lib.yaml
      service: geoportal
    volumes_from:
      - config:ro
    volumes:
      - /var/sig:/var/sig:ro

  alembic:
    extends:
      file: docker-compose-lib.yaml
      service: alembic

  front:
    extends:
      file: docker-compose-lib.yaml
      service: front
    volumes_from:
      - config:ro

  # Rich image for project development with e.-g. vim, tree, awscli, psql, ...
  tools:
    volumes_from:
      - config:rw
    volumes:
      - .:/src
    extends:
      file: docker-compose-lib.yaml
      service: tools

  # lux specific additions
  elasticsearch:
    image: elasticsearch:5.0
    environment:
      ES_JAVA_OPTS: -Xmx512m -Xms512m
    volumes:
      - ./config/elasticsearch-config:/usr/share/elasticsearch/config:ro
    ports:
      - 9200:9200

  ldap:
    image: lux-dev-ldap

